<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Click Trainer - Dota 2</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #1a1a2e;
      color: #e0e0e0;
      min-height: 100vh;
      display: flex;
    }

    /* Sidebar */
    .sidebar {
      width: 220px;
      min-height: 100vh;
      background: #0f1a2e;
      border-right: 1px solid #0f3460;
      display: flex;
      flex-direction: column;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 200;
      transition: transform 0.3s;
    }

    .sidebar-brand {
      padding: 20px 16px;
      border-bottom: 2px solid #e94560;
      text-align: center;
    }

    .sidebar-brand h2 {
      font-size: 1.1rem;
      color: #e94560;
      letter-spacing: 1px;
    }

    .sidebar-brand span {
      font-size: 0.65rem;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .sidebar nav {
      padding: 12px 0;
      flex: 1;
    }

    .sidebar nav a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      color: #888;
      text-decoration: none;
      font-size: 0.9rem;
      transition: all 0.2s;
      border-left: 3px solid transparent;
    }

    .sidebar nav a:hover {
      color: #e0e0e0;
      background: rgba(233, 69, 96, 0.05);
    }

    .sidebar nav a.active {
      color: #e94560;
      background: rgba(233, 69, 96, 0.1);
      border-left-color: #e94560;
    }

    .sidebar nav a .nav-icon {
      width: 20px;
      text-align: center;
      font-size: 1rem;
    }

    .main-content {
      flex: 1;
      margin-left: 220px;
    }

    .sidebar-toggle {
      display: none;
      position: fixed;
      top: 12px;
      left: 12px;
      z-index: 300;
      background: #0f1a2e;
      border: 1px solid #0f3460;
      color: #e0e0e0;
      padding: 8px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1.2rem;
      line-height: 1;
    }

    .sidebar-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      z-index: 199;
    }
    .sidebar-overlay.open { display: block; }

    @media (max-width: 768px) {
      .sidebar { transform: translateX(-100%); }
      .sidebar.open { transform: translateX(0); }
      .sidebar-toggle { display: block; }
      .main-content { margin-left: 0; }
    }

    header {
      background: linear-gradient(135deg, #16213e, #0f3460);
      padding: 20px;
      text-align: center;
      border-bottom: 2px solid #e94560;
    }

    header h1 {
      font-size: 2rem;
      color: #e94560;
      letter-spacing: 2px;
    }

    /* Pre-game screen */
    .screen { display: none; }
    .screen.active { display: block; }

    #pregame-screen.active {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: calc(100vh - 72px);
      padding: 20px;
    }

    .intro-card {
      background: #16213e;
      border: 1px solid #0f3460;
      border-radius: 12px;
      padding: 40px;
      max-width: 520px;
      width: 100%;
      text-align: center;
    }

    .intro-card h2 {
      font-size: 1.5rem;
      color: #e94560;
      margin-bottom: 16px;
    }

    .intro-card p {
      color: #aaa;
      font-size: 0.9rem;
      line-height: 1.6;
      margin-bottom: 12px;
    }

    .intro-rules {
      text-align: left;
      margin: 20px 0;
      padding: 16px;
      background: #1a1a2e;
      border-radius: 8px;
    }

    .intro-rules div {
      display: flex;
      gap: 10px;
      padding: 8px 0;
      font-size: 0.85rem;
      color: #ccc;
      border-bottom: 1px solid #0f3460;
    }

    .intro-rules div:last-child { border-bottom: none; }

    .intro-rules .rule-icon {
      color: #e94560;
      font-size: 1rem;
      min-width: 20px;
      text-align: center;
    }

    .btn-start {
      background: #e94560;
      color: #fff;
      border: none;
      padding: 14px 48px;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      letter-spacing: 1px;
      transition: background 0.2s;
      margin-top: 10px;
    }

    .btn-start:hover { background: #d63651; }

    /* Game HUD */
    .game-hud {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 32px;
      padding: 12px 20px;
      background: #16213e;
      border-bottom: 1px solid #0f3460;
      flex-wrap: wrap;
    }

    .hud-item {
      text-align: center;
    }

    .hud-label {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #888;
      margin-bottom: 2px;
    }

    .hud-value {
      font-size: 1.3rem;
      font-weight: 700;
      color: #e0e0e0;
    }

    .hud-value.accent { color: #e94560; }

    .hud-timer {
      width: 100%;
      height: 3px;
      background: #0f3460;
    }

    .hud-timer-bar {
      height: 100%;
      background: #e94560;
      width: 100%;
      transition: width linear;
    }

    /* Game area */
    .game-area {
      height: calc(100vh - 72px - 65px - 3px);
      min-height: 400px;
    }

    /* Quiz panel — overlay centered on click grid */
    .quiz-panel {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      background: rgba(22, 33, 62, 0.85);
      border: 1px solid #0f3460;
      border-radius: 12px;
      max-width: 400px;
      width: 90%;
    }

    .quiz-hero-img {
      width: 180px;
      border-radius: 8px;
      border: 2px solid #0f3460;
      margin-bottom: 16px;
      aspect-ratio: 16/9;
      object-fit: cover;
      background: #1a1a2e;
    }

    .quiz-question {
      font-size: 1rem;
      text-align: center;
      margin-bottom: 16px;
      min-height: 28px;
      color: #e0e0e0;
    }

    .quiz-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      width: 100%;
      max-width: 360px;
    }

    .quiz-option {
      padding: 12px 8px;
      background: #1a1a2e;
      border: 1px solid #0f3460;
      border-radius: 8px;
      color: #e0e0e0;
      font-size: 0.85rem;
      pointer-events: none;
      transition: all 0.15s;
      text-align: center;
      font-weight: 500;
    }

    .key-hint {
      display: inline-block;
      width: 20px;
      height: 20px;
      line-height: 20px;
      border-radius: 4px;
      background: rgba(255,255,255,0.1);
      border: 1px solid #0f3460;
      font-size: 0.7rem;
      font-weight: 700;
      color: #888;
      text-align: center;
      margin-right: 6px;
      vertical-align: middle;
    }

    .quiz-option.correct {
      background: rgba(39, 174, 96, 0.25);
      border-color: #27ae60;
      color: #2ecc71;
    }

    .quiz-option.wrong {
      background: rgba(231, 76, 60, 0.25);
      border-color: #e74c3c;
      color: #e74c3c;
    }

    .quiz-option.disabled {
      opacity: 0.5;
    }

    .quiz-option.disabled.correct { opacity: 1; }

    .quiz-feedback {
      margin-top: 12px;
      font-size: 0.85rem;
      min-height: 22px;
      font-weight: 600;
    }

    .quiz-feedback.correct { color: #2ecc71; }
    .quiz-feedback.wrong { color: #e74c3c; }
    .quiz-feedback.missed { color: #888; }

    .quiz-timer-bar-wrap {
      width: 100%;
      max-width: 360px;
      height: 4px;
      background: #0f3460;
      border-radius: 2px;
      margin-top: 14px;
    }

    .quiz-timer-bar {
      height: 100%;
      background: #e94560;
      border-radius: 2px;
      width: 100%;
      transition: width linear;
    }

    /* Click grid */
    .click-grid {
      width: 100%;
      height: 100%;
      background: #0a0a0a;
      position: relative;
      cursor: crosshair;
      overflow: hidden;
      user-select: none;
    }

    .click-grid-label {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #333;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      pointer-events: none;
    }

    .dot {
      position: absolute;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: #e94560;
      transform: translate(-50%, -50%);
      cursor: pointer;
      animation: dot-spawn 0.15s ease-out;
      box-shadow: 0 0 12px rgba(233, 69, 96, 0.6);
      z-index: 20;
    }

    @keyframes dot-spawn {
      0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }

    .dot.hit {
      animation: dot-hit 0.25s ease-out forwards;
      pointer-events: none;
    }

    @keyframes dot-hit {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1.8); opacity: 0; }
    }

    .dot.missed {
      animation: dot-miss 0.3s ease-out forwards;
      pointer-events: none;
    }

    @keyframes dot-miss {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 1; background: #e94560; }
      100% { transform: translate(-50%, -50%) scale(0.3); opacity: 0; background: #555; }
    }

    .click-timer-bar-wrap {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: #1a1a2e;
      z-index: 5;
    }

    .click-timer-bar {
      height: 100%;
      background: #e94560;
      width: 100%;
      transition: width linear;
    }

    /* Results screen */
    #results-screen.active {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: calc(100vh - 72px);
      padding: 20px;
    }

    .results-card {
      background: #16213e;
      border: 1px solid #0f3460;
      border-radius: 12px;
      padding: 40px;
      max-width: 480px;
      width: 100%;
      text-align: center;
    }

    .results-grade {
      font-size: 4rem;
      font-weight: 800;
      color: #e94560;
      line-height: 1;
      margin-bottom: 4px;
    }

    .results-comment {
      font-size: 1rem;
      color: #aaa;
      margin-bottom: 24px;
    }

    .results-breakdown {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-bottom: 20px;
    }

    .results-stat {
      text-align: center;
      padding: 16px 20px;
      background: #1a1a2e;
      border-radius: 8px;
      min-width: 110px;
    }

    .results-stat .rs-value {
      font-size: 2rem;
      font-weight: 700;
      color: #fff;
    }

    .results-stat .rs-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #888;
      margin-top: 4px;
    }

    .results-total {
      font-size: 1.1rem;
      margin-bottom: 24px;
      color: #ccc;
    }

    .results-total strong {
      color: #e94560;
      font-size: 1.4rem;
    }

    .btn-replay {
      background: #e94560;
      color: #fff;
      border: none;
      padding: 12px 40px;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      letter-spacing: 1px;
      transition: background 0.2s;
    }

    .btn-replay:hover { background: #d63651; }

    /* Responsive */
    @media (max-width: 768px) {
      .quiz-panel {
        max-width: 320px;
        padding: 16px;
      }

      .quiz-hero-img { width: 120px; }

      .game-hud { gap: 16px; }

      .results-breakdown { gap: 12px; }
      .results-stat { min-width: 90px; padding: 12px; }
    }
  </style>
</head>
<body>
  <button class="sidebar-toggle" id="sidebar-toggle">&#9776;</button>
  <div class="sidebar-overlay" id="sidebar-overlay"></div>

  <aside class="sidebar" id="sidebar">
    <div class="sidebar-brand">
      <h2>DOTA 2</h2>
      <span>Analysis</span>
    </div>
    <nav>
      <a href="index.html">
        <span class="nav-icon">&#9813;</span>
        Hero Stats
      </a>
      <a href="compare.html">
        <span class="nav-icon">&#9878;</span>
        Hero Comparison
      </a>
      <a href="lane-matchup.html">
        <span class="nav-icon">&#9876;</span>
        Lane Matchup
      </a>
      <a href="click-trainer.html" class="active">
        <span class="nav-icon">&#9678;</span>
        Click Trainer
      </a>
    </nav>
  </aside>

  <div class="main-content">
    <header>
      <h1>Click Trainer</h1>
    </header>

    <!-- Pre-game -->
    <div id="pregame-screen" class="screen active">
      <div class="intro-card">
        <h2>Multitask Training</h2>
        <p>Test your Dota 2 knowledge and reflexes at the same time. Answer hero quiz questions while clicking appearing dots before they vanish.</p>
        <div class="intro-rules">
          <div>
            <span class="rule-icon">&#9881;</span>
            <span>30 rounds, 3 seconds each (90s total)</span>
          </div>
          <div>
            <span class="rule-icon">&#9733;</span>
            <span>Quiz: answer hero questions for 1 point each (press 1-4)</span>
          </div>
          <div>
            <span class="rule-icon">&#9678;</span>
            <span>Clicks: hit the dot within 1 second for 1 point each</span>
          </div>
          <div>
            <span class="rule-icon">&#9876;</span>
            <span>Max score: 60 (30 quiz + 30 clicks)</span>
          </div>
        </div>
        <button class="btn-start" id="btn-start">Start Game</button>
      </div>
    </div>

    <!-- Game -->
    <div id="game-screen" class="screen">
      <div class="game-hud">
        <div class="hud-item">
          <div class="hud-label">Round</div>
          <div class="hud-value" id="hud-round">0 / 30</div>
        </div>
        <div class="hud-item">
          <div class="hud-label">Timer</div>
          <div class="hud-value accent" id="hud-timer">60s</div>
        </div>
        <div class="hud-item">
          <div class="hud-label">Quiz Score</div>
          <div class="hud-value" id="hud-quiz">0</div>
        </div>
        <div class="hud-item">
          <div class="hud-label">Click Score</div>
          <div class="hud-value" id="hud-clicks">0</div>
        </div>
      </div>
      <div class="hud-timer">
        <div class="hud-timer-bar" id="hud-timer-bar"></div>
      </div>

      <div class="game-area">
        <div class="click-grid" id="click-grid">
          <div class="quiz-panel">
            <img class="quiz-hero-img" id="quiz-img" src="" alt="">
            <div class="quiz-question" id="quiz-question"></div>
            <div class="quiz-options" id="quiz-options"></div>
            <div class="quiz-feedback" id="quiz-feedback"></div>
            <div class="quiz-timer-bar-wrap">
              <div class="quiz-timer-bar" id="quiz-timer-bar"></div>
            </div>
          </div>
          <div class="click-grid-label">Click the dots!</div>
          <div class="click-timer-bar-wrap">
            <div class="click-timer-bar" id="click-timer-bar"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Results -->
    <div id="results-screen" class="screen">
      <div class="results-card">
        <div class="results-grade" id="results-grade"></div>
        <div class="results-comment" id="results-comment"></div>
        <div class="results-breakdown">
          <div class="results-stat">
            <div class="rs-value" id="results-quiz">0</div>
            <div class="rs-label">Quiz (/ 30)</div>
          </div>
          <div class="results-stat">
            <div class="rs-value" id="results-clicks">0</div>
            <div class="rs-label">Clicks (/ 30)</div>
          </div>
        </div>
        <div class="results-total">
          Combined: <strong id="results-total">0</strong> / 60
        </div>
        <button class="btn-replay" id="btn-replay">Play Again</button>
      </div>
    </div>
  </div>

  <script src="resources/hero-trivia-quizzes.js"></script>
  <script>
    const CDN = 'https://cdn.cloudflare.steamstatic.com';
    const TOTAL_ROUNDS = 30;
    const ROUND_DURATION = 3000;
    const DOT_LIFETIME = 1000;

    // State
    let round = 0;
    let quizScore = 0;
    let clickScore = 0;
    let answered = false;
    let correctAnswer = null;
    let roundInterval = null;
    let globalTimerInterval = null;
    let dotTimeout = null;
    let gameStartTime = 0;
    let usedQuizIndices = [];

    // DOM
    const $pregame = document.getElementById('pregame-screen');
    const $game = document.getElementById('game-screen');
    const $results = document.getElementById('results-screen');
    const $hudRound = document.getElementById('hud-round');
    const $hudTimer = document.getElementById('hud-timer');
    const $hudQuiz = document.getElementById('hud-quiz');
    const $hudClicks = document.getElementById('hud-clicks');
    const $hudTimerBar = document.getElementById('hud-timer-bar');
    const $quizImg = document.getElementById('quiz-img');
    const $quizQuestion = document.getElementById('quiz-question');
    const $quizOptions = document.getElementById('quiz-options');
    const $quizFeedback = document.getElementById('quiz-feedback');
    const $quizTimerBar = document.getElementById('quiz-timer-bar');
    const $clickGrid = document.getElementById('click-grid');
    const $clickTimerBar = document.getElementById('click-timer-bar');

    function showScreen(screen) {
      $pregame.classList.remove('active');
      $game.classList.remove('active');
      $results.classList.remove('active');
      screen.classList.add('active');
    }

    function generateQuestion() {
      if (usedQuizIndices.length >= HERO_TRIVIA_QUIZZES.length) usedQuizIndices = [];
      let idx;
      do {
        idx = Math.floor(Math.random() * HERO_TRIVIA_QUIZZES.length);
      } while (usedQuizIndices.includes(idx));
      usedQuizIndices.push(idx);
      const q = HERO_TRIVIA_QUIZZES[idx];

      correctAnswer = q.answer;
      answered = false;

      $quizImg.src = CDN + q.img;
      $quizQuestion.textContent = q.text;
      $quizFeedback.textContent = '';
      $quizFeedback.className = 'quiz-feedback';

      $quizOptions.innerHTML = q.options.map((opt, i) =>
        `<button class="quiz-option" data-answer="${opt.replace(/"/g, '&quot;')}"><span class="key-hint">${i + 1}</span>${opt}</button>`
      ).join('');

      // Animate quiz timer bar
      $quizTimerBar.style.transition = 'none';
      $quizTimerBar.style.width = '100%';
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          $quizTimerBar.style.transition = `width ${ROUND_DURATION}ms linear`;
          $quizTimerBar.style.width = '0%';
        });
      });
    }

    function handleAnswer(btn) {
      if (answered) return;
      answered = true;

      const selected = btn.dataset.answer;
      const isCorrect = selected === correctAnswer;

      // Disable all buttons
      $quizOptions.querySelectorAll('.quiz-option').forEach(b => {
        b.classList.add('disabled');
        if (b.dataset.answer === correctAnswer) b.classList.add('correct');
      });

      if (isCorrect) {
        btn.classList.add('correct');
        quizScore++;
        $quizFeedback.textContent = 'Correct!';
        $quizFeedback.className = 'quiz-feedback correct';
      } else {
        btn.classList.add('wrong');
        $quizFeedback.textContent = `Wrong! ${correctAnswer}`;
        $quizFeedback.className = 'quiz-feedback wrong';
      }

      $hudQuiz.textContent = quizScore;
    }

    function markMissed() {
      if (!answered) {
        answered = true;
        $quizOptions.querySelectorAll('.quiz-option').forEach(b => {
          b.classList.add('disabled');
          if (b.dataset.answer === correctAnswer) b.classList.add('correct');
        });
        $quizFeedback.textContent = `Missed! ${correctAnswer}`;
        $quizFeedback.className = 'quiz-feedback missed';
      }
    }

    function spawnDot() {
      // Remove any existing dot
      const oldDot = $clickGrid.querySelector('.dot');
      if (oldDot) oldDot.remove();
      clearTimeout(dotTimeout);

      const grid = $clickGrid.getBoundingClientRect();
      const pad = 30;
      const x = pad + Math.random() * (grid.width - pad * 2);
      const y = pad + Math.random() * (grid.height - pad * 2 - 4); // -4 for timer bar

      const dot = document.createElement('div');
      dot.className = 'dot';
      dot.style.left = x + 'px';
      dot.style.top = y + 'px';
      $clickGrid.appendChild(dot);

      dot.addEventListener('click', (e) => {
        e.stopPropagation();
        handleDotClick(dot);
      });

      // Animate click timer bar
      $clickTimerBar.style.transition = 'none';
      $clickTimerBar.style.width = '100%';
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          $clickTimerBar.style.transition = `width ${DOT_LIFETIME}ms linear`;
          $clickTimerBar.style.width = '0%';
        });
      });

      dotTimeout = setTimeout(() => {
        if (dot.parentNode && !dot.classList.contains('hit')) {
          dot.classList.add('missed');
          setTimeout(() => dot.remove(), 300);
        }
      }, DOT_LIFETIME);
    }

    function handleDotClick(dot) {
      if (dot.classList.contains('hit') || dot.classList.contains('missed')) return;
      dot.classList.add('hit');
      clickScore++;
      $hudClicks.textContent = clickScore;
      clearTimeout(dotTimeout);
      setTimeout(() => dot.remove(), 250);
    }

    function startGame() {
      round = 0;
      quizScore = 0;
      clickScore = 0;
      usedQuizIndices = [];
      $hudQuiz.textContent = '0';
      $hudClicks.textContent = '0';
      $hudRound.textContent = '0 / ' + TOTAL_ROUNDS;

      showScreen($game);
      gameStartTime = Date.now();

      // Global timer bar
      $hudTimerBar.style.transition = 'none';
      $hudTimerBar.style.width = '100%';
      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          $hudTimerBar.style.transition = `width ${TOTAL_ROUNDS * ROUND_DURATION}ms linear`;
          $hudTimerBar.style.width = '0%';
        });
      });

      // Update countdown timer
      globalTimerInterval = setInterval(() => {
        const elapsed = Date.now() - gameStartTime;
        const remaining = Math.max(0, Math.ceil((TOTAL_ROUNDS * ROUND_DURATION - elapsed) / 1000));
        $hudTimer.textContent = remaining + 's';
      }, 250);

      // Start first round immediately
      nextRound();
      roundInterval = setInterval(() => {
        nextRound();
      }, ROUND_DURATION);
    }

    function nextRound() {
      // Mark previous question as missed if unanswered
      if (round > 0) markMissed();

      round++;
      if (round > TOTAL_ROUNDS) {
        endGame();
        return;
      }

      $hudRound.textContent = round + ' / ' + TOTAL_ROUNDS;
      generateQuestion();
      spawnDot();
    }

    function endGame() {
      clearInterval(roundInterval);
      clearInterval(globalTimerInterval);
      clearTimeout(dotTimeout);
      roundInterval = null;
      globalTimerInterval = null;

      // Clean up remaining dot
      const dot = $clickGrid.querySelector('.dot');
      if (dot) dot.remove();

      // Mark last question if unanswered
      markMissed();

      showResults();
    }

    function showResults() {
      const total = quizScore + clickScore;
      const pct = Math.round((total / 60) * 100);

      let grade, comment;
      if (pct >= 90) { grade = 'S'; comment = 'Immortal — you are the top 0.1%'; }
      else if (pct >= 80) { grade = 'A'; comment = 'Divine — exceptional multitasking'; }
      else if (pct >= 70) { grade = 'B'; comment = 'Ancient — solid game knowledge & reflexes'; }
      else if (pct >= 60) { grade = 'C'; comment = 'Legend — room to improve'; }
      else if (pct >= 50) { grade = 'D'; comment = 'Archon — keep practicing!'; }
      else { grade = 'F'; comment = 'Herald — the journey begins here'; }

      document.getElementById('results-grade').textContent = grade;
      document.getElementById('results-comment').textContent = comment;
      document.getElementById('results-quiz').textContent = quizScore;
      document.getElementById('results-clicks').textContent = clickScore;
      document.getElementById('results-total').textContent = total;

      showScreen($results);
    }

    // Event listeners
    document.getElementById('btn-start').addEventListener('click', startGame);
    document.getElementById('btn-replay').addEventListener('click', () => {
      showScreen($pregame);
    });

    // Keyboard shortcuts for quiz answers (1-4)
    document.addEventListener('keydown', (e) => {
      if (!$game.classList.contains('active') || answered) return;
      const idx = parseInt(e.key) - 1;
      if (idx < 0 || isNaN(idx)) return;
      const btns = $quizOptions.querySelectorAll('.quiz-option');
      if (idx < btns.length) handleAnswer(btns[idx]);
    });

    // Sidebar toggle
    document.getElementById('sidebar-toggle').addEventListener('click', () => {
      document.getElementById('sidebar').classList.toggle('open');
      document.getElementById('sidebar-overlay').classList.toggle('open');
    });
    document.getElementById('sidebar-overlay').addEventListener('click', () => {
      document.getElementById('sidebar').classList.remove('open');
      document.getElementById('sidebar-overlay').classList.remove('open');
    });
  </script>
</body>
</html>
